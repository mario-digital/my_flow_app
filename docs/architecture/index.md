# My Flow Fullstack Architecture Document

## Table of Contents

- [My Flow Fullstack Architecture Document](#table-of-contents)
  - [Introduction](./introduction.md)
    - [Starter Template or Existing Project](./introduction.md#starter-template-or-existing-project)
    - [Change Log](./introduction.md#change-log)
  - [High Level Architecture](./high-level-architecture.md)
    - [Technical Summary](./high-level-architecture.md#technical-summary)
    - [Platform and Infrastructure Choice](./high-level-architecture.md#platform-and-infrastructure-choice)
    - [Repository Structure](./high-level-architecture.md#repository-structure)
    - [High Level Architecture Diagram](./high-level-architecture.md#high-level-architecture-diagram)
    - [Architectural Patterns](./high-level-architecture.md#architectural-patterns)
  - [Data Models](./data-models.md)
    - [Context Model](./data-models.md#context-model)
      - [TypeScript Interface](./data-models.md#typescript-interface)
      - [Relationships](./data-models.md#relationships)
    - [Flow Model](./data-models.md#flow-model)
      - [TypeScript Interface](./data-models.md#typescript-interface)
      - [Relationships](./data-models.md#relationships)
    - [UserPreferences Model](./data-models.md#userpreferences-model)
      - [TypeScript Interface](./data-models.md#typescript-interface)
      - [Relationships](./data-models.md#relationships)
      - [Default Values](./data-models.md#default-values)
    - [Conversation Model](./data-models.md#conversation-model)
    - [Database Indexes (MongoDB)](./data-models.md#database-indexes-mongodb)
  - [Tech Stack](./tech-stack.md)
    - [Technology Stack Table](./tech-stack.md#technology-stack-table)
  - [API Specification](./api-specification.md)
    - [Base URL](./api-specification.md#base-url)
    - [Authentication](./api-specification.md#authentication)
    - [API Endpoints Overview](./api-specification.md#api-endpoints-overview)
    - [OpenAPI 3.1 Specification](./api-specification.md#openapi-31-specification)
    - [Request/Response Examples](./api-specification.md#requestresponse-examples)
      - [Create Context](./api-specification.md#create-context)
      - [Create Flow with Due Date](./api-specification.md#create-flow-with-due-date)
      - [Get Flows with Status](./api-specification.md#get-flows-with-status)
      - [Update User Preferences](./api-specification.md#update-user-preferences)
    - [Error Responses](./api-specification.md#error-responses)
    - [API Design Decisions](./api-specification.md#api-design-decisions)
  - [Components](./components.md)
    - [Component Architecture Overview](./components.md#component-architecture-overview)
    - [Frontend Components](./components.md#frontend-components)
      - [1. App Shell (Server Component)](./components.md#1-app-shell-server-component)
      - [2. Context Switcher (Client Component)](./components.md#2-context-switcher-client-component)
      - [3. Flow List (Hybrid - Server + Client Components)](./components.md#3-flow-list-hybrid-server-client-components)
      - [4. Flow Detail (Server Component with Client Islands)](./components.md#4-flow-detail-server-component-with-client-islands)
      - [5. AI Chat Interface (Client Component - Future Epic 3)](./components.md#5-ai-chat-interface-client-component-future-epic-3)
      - [6. TanStack Query Client (State Management Layer)](./components.md#6-tanstack-query-client-state-management-layer)
      - [7. API Client Layer (Frontend)](./components.md#7-api-client-layer-frontend)
    - [Backend Components](./components.md#backend-components)
      - [8. API Gateway / Router (FastAPI)](./components.md#8-api-gateway-router-fastapi)
      - [9. Auth Middleware (FastAPI Dependency)](./components.md#9-auth-middleware-fastapi-dependency)
      - [10. Context Service](./components.md#10-context-service)
      - [11. Flow Service](./components.md#11-flow-service)
      - [12. User Preferences Service](./components.md#12-user-preferences-service)
      - [13. AI Service (Future - Epic 3)](./components.md#13-ai-service-future-epic-3)
      - [14. Context Repository](./components.md#14-context-repository)
      - [15. Flow Repository](./components.md#15-flow-repository)
      - [16. User Preferences Repository](./components.md#16-user-preferences-repository)
      - [17. AI Provider Adapter (Future - Epic 3)](./components.md#17-ai-provider-adapter-future-epic-3)
    - [Cross-Cutting Concerns](./components.md#cross-cutting-concerns)
      - [Error Handling Strategy](./components.md#error-handling-strategy)
      - [Logging and Observability](./components.md#logging-and-observability)
      - [Testing Boundaries](./components.md#testing-boundaries)
  - [Frontend Architecture](./frontend-architecture.md)
    - [Component Organization](./frontend-architecture.md#component-organization)
    - [React Server Components Strategy](./frontend-architecture.md#react-server-components-strategy)
    - [State Management Architecture](./frontend-architecture.md#state-management-architecture)
      - [1. Server State (TanStack Query)](./frontend-architecture.md#1-server-state-tanstack-query)
      - [2. Local UI State (React Context)](./frontend-architecture.md#2-local-ui-state-react-context)
    - [CSS Design Tokens Implementation](./frontend-architecture.md#css-design-tokens-implementation)
    - [Routing and Navigation](./frontend-architecture.md#routing-and-navigation)
    - [Performance Optimizations](./frontend-architecture.md#performance-optimizations)
    - [Error Handling and Loading States](./frontend-architecture.md#error-handling-and-loading-states)
    - [Accessibility Considerations](./frontend-architecture.md#accessibility-considerations)
    - [Frontend Build Configuration](./frontend-architecture.md#frontend-build-configuration)
  - [Backend Architecture](./backend-architecture.md)
    - [Service Organization](./backend-architecture.md#service-organization)
    - [FastAPI Application Entry Point](./backend-architecture.md#fastapi-application-entry-point)
    - [Configuration Management](./backend-architecture.md#configuration-management)
    - [Database Connection Setup](./backend-architecture.md#database-connection-setup)
    - [Pydantic Models (Request/Response Schemas)](./backend-architecture.md#pydantic-models-requestresponse-schemas)
    - [Repository Layer (Data Access)](./backend-architecture.md#repository-layer-data-access)
    - [Service Layer (Business Logic)](./backend-architecture.md#service-layer-business-logic)
    - [Router Layer (API Endpoints)](./backend-architecture.md#router-layer-api-endpoints)
    - [Authentication Middleware](./backend-architecture.md#authentication-middleware)
    - [Error Handling](./backend-architecture.md#error-handling)
    - [Logging Configuration](./backend-architecture.md#logging-configuration)
    - [Deployment Configuration](./backend-architecture.md#deployment-configuration)
  - [9. Unified Project Structure](./9-unified-project-structure.md)
  - [10. Development Workflow](./10-development-workflow.md)
    - [Prerequisites](./10-development-workflow.md#prerequisites)
    - [Initial Setup](./10-development-workflow.md#initial-setup)
    - [Development Commands](./10-development-workflow.md#development-commands)
    - [Environment Configuration](./10-development-workflow.md#environment-configuration)
    - [Common Development Scenarios](./10-development-workflow.md#common-development-scenarios)
    - [Design Rationale](./10-development-workflow.md#design-rationale)
  - [11. Deployment Architecture](./11-deployment-architecture.md)
    - [Frontend Deployment](./11-deployment-architecture.md#frontend-deployment)
    - [Backend Deployment](./11-deployment-architecture.md#backend-deployment)
    - [Database Deployment](./11-deployment-architecture.md#database-deployment)
    - [CI/CD Pipeline](./11-deployment-architecture.md#cicd-pipeline)
    - [Environments](./11-deployment-architecture.md#environments)
    - [Rollback Strategy](./11-deployment-architecture.md#rollback-strategy)
    - [Monitoring and Alerting](./11-deployment-architecture.md#monitoring-and-alerting)
    - [Design Rationale](./11-deployment-architecture.md#design-rationale)
  - [12. Security and Performance](./12-security-and-performance.md)
    - [Security Requirements](./12-security-and-performance.md#security-requirements)
    - [Performance Optimization](./12-security-and-performance.md#performance-optimization)
    - [Design Rationale](./12-security-and-performance.md#design-rationale)
  - [13. Testing Strategy](./13-testing-strategy.md)
    - [Testing Pyramid](./13-testing-strategy.md#testing-pyramid)
    - [Test Organization](./13-testing-strategy.md#test-organization)
    - [Test Examples](./13-testing-strategy.md#test-examples)
    - [Test Configuration](./13-testing-strategy.md#test-configuration)
    - [Test Coverage Requirements](./13-testing-strategy.md#test-coverage-requirements)
    - [Design Rationale](./13-testing-strategy.md#design-rationale)
  - [14. Coding Standards](coding-standards.md)
    - [Critical Fullstack Rules](coding-standards.md#critical-fullstack-rules)
      - [1. Type Sharing Pattern](coding-standards.md#1-type-sharing-pattern)
      - [2. API Call Conventions](coding-standards.md#2-api-call-conventions)
      - [3. Environment Variable Access](coding-standards.md#3-environment-variable-access)
      - [4. State Update Patterns](coding-standards.md#4-state-update-patterns)
      - [5. Error Handling Standards](coding-standards.md#5-error-handling-standards)
      - [6. Server Component Rules](coding-standards.md#6-server-component-rules)
      - [7. Database Query Patterns](coding-standards.md#7-database-query-patterns)
    - [Naming Conventions](coding-standards.md#naming-conventions)
    - [File Organization Rules](coding-standards.md#file-organization-rules)
    - [Import Order Standards](coding-standards.md#import-order-standards)
    - [Design Decisions](coding-standards.md#design-decisions)
  - [15. Error Handling Strategy](./15-error-handling-strategy.md)
    - [Error Flow Diagram](./15-error-handling-strategy.md#error-flow-diagram)
    - [Error Response Format](./15-error-handling-strategy.md#error-response-format)
    - [Frontend Error Handling](./15-error-handling-strategy.md#frontend-error-handling)
    - [Backend Error Handling](./15-error-handling-strategy.md#backend-error-handling)
    - [Error Categories and Status Codes](./15-error-handling-strategy.md#error-categories-and-status-codes)
    - [Logging and Monitoring](./15-error-handling-strategy.md#logging-and-monitoring)
    - [Design Rationale](./15-error-handling-strategy.md#design-rationale)
  - [16. Monitoring and Observability](./16-monitoring-and-observability.md)
    - [Monitoring Stack](./16-monitoring-and-observability.md#monitoring-stack)
    - [Key Metrics](./16-monitoring-and-observability.md#key-metrics)
    - [Instrumentation](./16-monitoring-and-observability.md#instrumentation)
    - [Health Check Endpoint](./16-monitoring-and-observability.md#health-check-endpoint)
    - [Alerting Configuration](./16-monitoring-and-observability.md#alerting-configuration)
    - [Dashboard Setup](./16-monitoring-and-observability.md#dashboard-setup)
    - [Design Rationale](./16-monitoring-and-observability.md#design-rationale)
  - [17. Architecture Validation Report](./17-architecture-validation-report.md)
    - [Executive Summary](./17-architecture-validation-report.md#executive-summary)
    - [Section Analysis](./17-architecture-validation-report.md#section-analysis)
      - [1. REQUIREMENTS ALIGNMENT (100% - 5/5 items passed)](./17-architecture-validation-report.md#1-requirements-alignment-100-55-items-passed)
      - [2. ARCHITECTURE FUNDAMENTALS (100% - 5/5 items passed)](./17-architecture-validation-report.md#2-architecture-fundamentals-100-55-items-passed)
      - [3. TECHNICAL STACK & DECISIONS (96% - 24/25 items passed)](./17-architecture-validation-report.md#3-technical-stack-decisions-96-2425-items-passed)
      - [4. FRONTEND DESIGN & IMPLEMENTATION (100% - 6/6 items passed)](./17-architecture-validation-report.md#4-frontend-design-implementation-100-66-items-passed)
      - [5. RESILIENCE & OPERATIONAL READINESS (100% - 4/4 items passed)](./17-architecture-validation-report.md#5-resilience-operational-readiness-100-44-items-passed)
      - [6. SECURITY & COMPLIANCE (100% - 4/4 items passed)](./17-architecture-validation-report.md#6-security-compliance-100-44-items-passed)
      - [7. IMPLEMENTATION GUIDANCE (100% - 5/5 items passed)](./17-architecture-validation-report.md#7-implementation-guidance-100-55-items-passed)
      - [8. DEPENDENCY & INTEGRATION MANAGEMENT (100% - 3/3 items passed)](./17-architecture-validation-report.md#8-dependency-integration-management-100-33-items-passed)
      - [9. AI AGENT IMPLEMENTATION SUITABILITY (100% - 4/4 items passed)](./17-architecture-validation-report.md#9-ai-agent-implementation-suitability-100-44-items-passed)
      - [10. ACCESSIBILITY IMPLEMENTATION (33% - 1/3 items passed)](./17-architecture-validation-report.md#10-accessibility-implementation-33-13-items-passed)
    - [Risk Assessment](./17-architecture-validation-report.md#risk-assessment)
      - [Top 5 Risks (by severity)](./17-architecture-validation-report.md#top-5-risks-by-severity)
    - [Recommendations](./17-architecture-validation-report.md#recommendations)
      - [Must-Fix Before Development (1 item)](./17-architecture-validation-report.md#must-fix-before-development-1-item)
      - [Should-Fix for Better Quality (3 items)](./17-architecture-validation-report.md#should-fix-for-better-quality-3-items)
      - [Nice-to-Have Improvements (2 items)](./17-architecture-validation-report.md#nice-to-have-improvements-2-items)
    - [AI Implementation Readiness](./17-architecture-validation-report.md#ai-implementation-readiness)
    - [Checklist Summary](./17-architecture-validation-report.md#checklist-summary)
    - [Conclusion](./17-architecture-validation-report.md#conclusion)
