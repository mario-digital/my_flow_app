#!/usr/bin/env sh

echo "🔍 Running pre-commit checks..."

# Run lint-staged for file-level checks
bunx lint-staged || { echo "❌ lint-staged failed"; exit 1; }

# Run full frontend lint to catch unstaged issues
echo "🧹 Linting frontend..."
bun --cwd my_flow_client run lint || { echo "❌ Frontend lint failed"; exit 1; }

# Type check frontend (quick check)
echo "📝 Type checking frontend..."
bun --cwd my_flow_client run typecheck || { echo "❌ Frontend type check failed"; exit 1; }

# Type check backend (quick check)
echo "🐍 Type checking backend..."
PYTHONPATH=./my_flow_api uv run --project my_flow_api mypy my_flow_api/src/ || { echo "❌ Backend type check failed"; exit 1; }

echo "✅ Pre-commit checks passed!"
